#!/bin/bash
# DO NOT EDIT THIS SHELL-SCRIPT
# author: sebbb
echo ===========================================================
echo This is the package maker for the picogen-Project.
echo ===========================================================

TARBALL_FILES=`find -wholename './packages' -prune -or \( -not -type f -or -print \)`

DIR_NAME="packages/$(date --iso-8601 --utc)"
TAR_NAME="$DIR_NAME/picogen.$(date --iso-8601 --utc).tar"
TAR_GZ_NAME=$TAR_NAME.gz
TAR_BZ2_NAME=$TAR_NAME.bz2

echo -----------------------------------------------------------
echo Creating raw tarballs.
echo -----------------------------------------------------------

echo packing the following files:
echo $TARBALL_FILES
echo 

# create tar-file, on success, create tar.gz and tar .bz2
echo
( ( echo creating directory $DIR_NAME;
    mkdir -p $DIR_NAME
  ) && (
          echo packing and creating tar-file $TAR_NAME;
          tar -cf $TAR_NAME $TARBALL_FILES;
  ) && (
          echo packing and creating tar.gz-file $TAR_GZ_NAME;
          gzip  -c9 $TAR_NAME > $TAR_GZ_NAME;
          echo packing and creating tar.bz2-file $TAR_BZ2_NAME;
          bzip2 -c9 $TAR_NAME > $TAR_BZ2_NAME;
) ) || ( echo failed )



echo -----------------------------------------------------------

